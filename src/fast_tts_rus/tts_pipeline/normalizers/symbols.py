"""Symbols and operators normalizer."""

from fast_tts_rus.tts_pipeline.constants import GREEK_LETTERS


class SymbolNormalizer:
    """Normalizes special symbols and operators to speakable text."""

    # Operators and symbols dictionary
    # Longer patterns first for correct matching
    SYMBOLS = {
        # Multi-character operators (must be checked first)
        "<->": "двунаправленная стрелка",
        "===": "строго равно",
        "!==": "строго не равно",
        "...": "троеточие",
        "::": "двойное двоеточие",
        "->": "стрелка",
        "=>": "толстая стрелка",
        "<-": "стрелка влево",
        ">=": "больше или равно",
        "<=": "меньше или равно",
        "!=": "не равно",
        "==": "равно равно",
        "&&": "и",
        "||": "или",
        "??": "нулевое слияние",
        "?.": "опциональная цепочка",
        "**": "степень",
        "//": "целочисленное деление",
        "++": "плюс плюс",
        "--": "минус минус",
        "+=": "плюс равно",
        "-=": "минус равно",
        "*=": "умножить равно",
        "/=": "делить равно",
        ":=": "присваивание",
        "<<": "сдвиг влево",
        ">>": "сдвиг вправо",
        # Single character - comparison/arithmetic
        "<": "меньше",
        ">": "больше",
        "=": "равно",
        "+": "плюс",
        "-": "минус",
        "*": "умножить",
        "/": "делить",
        "%": "процент",
        "!": "восклицательный знак",
        "?": "вопросительный знак",
        # Bitwise
        "&": "амперсанд",
        "|": "пайп",
        "^": "каретка",
        "~": "тильда",
        # Punctuation
        ".": "точка",
        ",": "запятая",
        ":": "двоеточие",
        ";": "точка с запятой",
        "_": "нижнее подчёркивание",
        "\\": "бэкслэш",
        # Brackets
        "(": "открывающая скобка",
        ")": "закрывающая скобка",
        "[": "открывающая квадратная скобка",
        "]": "закрывающая квадратная скобка",
        "{": "открывающая фигурная скобка",
        "}": "закрывающая фигурная скобка",
        # Special characters
        "@": "собака",
        "#": "решётка",
        "$": "доллар",
        # Quotes
        '"': "кавычка",
        "'": "апостроф",
        "`": "обратная кавычка",
        "«": "открывающая кавычка",
        "»": "закрывающая кавычка",
        # Unicode symbols
        "©": "копирайт",
        "®": "зарегистрировано",
        "™": "торговая марка",
        "°": "градус",
        "±": "плюс минус",
        # Greek letters
        **GREEK_LETTERS,
    }

    def normalize(self, symbol: str) -> str:
        """Convert symbol/operator to speakable text."""
        if symbol in self.SYMBOLS:
            return self.SYMBOLS[symbol]
        # Return as-is if unknown
        return symbol
